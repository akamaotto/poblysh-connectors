## ADDED Requirements

### Requirement: Postgres Connection Management
The system SHALL use SeaORM to manage a connection pool to Postgres using `POBLYSH_DATABASE_URL`. Connections MUST be established during startup and made available to request handlers and background tasks.

Pool behavior (MVP):
- Default max connections: 10 (configurable)
- Acquire timeout: 5s (configurable)
- Retry on transient errors with backoff during startup initialization

#### Scenario: Connects with valid database URL
- GIVEN `POBLYSH_DATABASE_URL` points to a reachable Postgres instance
- WHEN the service starts
- THEN a `DatabaseConnection` pool is created and stored in application state

#### Scenario: Invalid credentials fail fast
- GIVEN `POBLYSH_DATABASE_URL` contains wrong credentials
- WHEN the service starts
- THEN initialization fails with an actionable error indicating authentication failed

### Requirement: Migration Runner
The system MUST include SeaORM Migrator and apply pending migrations. For profiles `local` and `test`, migrations SHALL run automatically on startup. For other profiles (e.g., `dev`, `prod`), migrations SHOULD be executed explicitly via a CLI entry or deployment step.

#### Scenario: Local profile runs migrations on startup
- GIVEN `POBLYSH_PROFILE=local`
- AND the database is empty
- WHEN the service starts
- THEN the migrator applies all pending migrations successfully

#### Scenario: Idempotent reruns
- GIVEN the database is already at the latest migration
- WHEN the migrator runs again
- THEN it completes without altering existing schema or data

### Requirement: Baseline Schema (Tenants)
The baseline schema SHALL include a `tenants` table to support tenant isolation across all future entities.

Columns (MVP):
- `id UUID PRIMARY KEY NOT NULL` (generated by application as UUID v4)
- `name TEXT NULL`
- `created_at TIMESTAMPTZ NOT NULL DEFAULT now()`

Constraints:
- Primary key on `id`

#### Scenario: Insert tenant succeeds
- GIVEN a newly generated UUID v4 `id`
- WHEN inserting into `tenants (id, name)`
- THEN the row is created and `created_at` is set automatically

#### Scenario: Duplicate id rejected
- GIVEN an existing row in `tenants` with `id = X`
- WHEN inserting another row with `id = X`
- THEN the operation fails due to primary key violation

